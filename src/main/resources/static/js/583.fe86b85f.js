"use strict";(self["webpackChunktext_generation_system"]=self["webpackChunktext_generation_system"]||[]).push([[583],{3583:function(e,l,a){a.r(l),a.d(l,{default:function(){return w}});a(4114),a(8111),a(2489);var t=a(6768),r=a(4232),o=a(144),n=a(1387),i=a(1219),s=a(164),u=a(8270),d=a(7477);const c={class:"event-graph-list-container"},p={class:"header"},g={class:"header-buttons"},k={class:"content-wrapper"},b={class:"content"},v={class:"description-cell"},f={class:"pagination-container"},m={class:"dialog-footer"};var h={__name:"list",setup(e){const l=(0,n.rd)(),a=(0,o.KR)(!1),h=(0,o.KR)([]),_=((0,o.KR)(0),(0,o.KR)("")),F=(0,o.KR)(!1),w=(0,o.KR)(!1),y=(0,o.KR)(null),C=(0,o.Kh)({title:"",description:""}),L=(0,o.KR)(0),x=(0,t.EW)((()=>{if(!_.value){const e=(K.page-1)*K.limit,l=e+K.limit;return h.value.slice(e,l)}const e=_.value.toLowerCase(),l=h.value.filter((l=>l.title.toLowerCase().includes(e)||l.description.toLowerCase().includes(e))),a=(K.page-1)*K.limit,t=a+K.limit;return l.slice(a,t)}));(0,t.wB)([_,h],(()=>{if(_.value){const e=_.value.toLowerCase(),l=h.value.filter((l=>l.title.toLowerCase().includes(e)||l.description.toLowerCase().includes(e)));L.value=l.length}else L.value=h.value.length}));const R=()=>{K.page=1,console.log("搜索查询:",_.value)},V={title:[{required:!0,message:"请输入事件图标题",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],description:[{required:!0,message:"请输入事件图描述",trigger:"blur"}]},K=(0,o.Kh)({page:1,limit:10,title:"",sort:"-updatedTime"}),z=e=>e||"",W=async()=>{a.value=!0;try{console.log("开始请求事件图列表...");const e=await(0,u.Z$)();console.log("事件图列表响应:",e),e&&e.success&&Array.isArray(e.data)?(h.value=e.data,L.value=e.data.length):Array.isArray(e)?(h.value=e,L.value=e.length):(h.value=[],L.value=0,e&&(e.message||e.error)&&i.nk.error(e.message||e.error))}catch(e){console.error("获取事件图列表失败:",e),i.nk.error("获取事件图失败"),h.value=[],L.value=0}finally{a.value=!1}},A=e=>{K.page=e,W()},U=e=>{K.limit=e,W()},B=()=>{C.title="",C.description="",F.value=!0},$=()=>{y.value.validate((async e=>{if(e){w.value=!0;try{const e=await(0,u.BU)(C);e&&e.success?(i.nk.success("创建成功"),F.value=!1,await W()):i.nk.error(e?.message||e?.error||"创建失败")}catch(l){console.error("创建事件图失败:",l),i.nk.error("创建事件图失败")}finally{w.value=!1}}}))},I=e=>{l.push(`/event-graph/detail/${e}`)},S=e=>{l.push(`/event-graph/visualize/${e}`)},T=e=>{l.push(`/text-generation/create?eventGraphId=${e}`)},j=e=>{console.log("跳转到事件图生成记录页面，事件图ID:",e),l.push(`/text-generation/records/${e}`)},q=e=>{s.s.confirm("确定要删除此事件图吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{D(e)})).catch((()=>{}))},D=async e=>{try{const l=await(0,u.Qi)(e);l&&l.success?(i.nk.success("删除成功"),await W()):i.nk.error(l?.message||l?.error||"删除事件图失败")}catch(l){console.error("删除事件图失败:",l),i.nk.error("删除事件图失败")}};return(0,t.sV)((()=>{W()})),(e,l)=>{const n=(0,t.g2)("el-input"),i=(0,t.g2)("el-button"),s=(0,t.g2)("el-table-column"),u=(0,t.g2)("el-icon"),h=(0,t.g2)("el-dropdown-item"),W=(0,t.g2)("el-dropdown-menu"),D=(0,t.g2)("el-dropdown"),E=(0,t.g2)("el-table"),G=(0,t.g2)("el-pagination"),X=(0,t.g2)("el-form-item"),N=(0,t.g2)("el-form"),P=(0,t.g2)("el-dialog"),Q=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",c,[(0,t.Lk)("div",p,[l[8]||(l[8]=(0,t.Lk)("div",null,[(0,t.Lk)("h2",null,"事件图列表")],-1)),(0,t.Lk)("div",g,[(0,t.bF)(n,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=e=>_.value=e),placeholder:"搜索事件图","prefix-icon":"Search",clearable:"",onInput:R,class:"search-input"},null,8,["modelValue"]),(0,t.bF)(i,{type:"primary",onClick:B},{default:(0,t.k6)((()=>l[7]||(l[7]=[(0,t.eW)("创建事件图")]))),_:1})])]),(0,t.Lk)("div",k,[(0,t.Lk)("div",b,[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(E,{data:x.value,border:""},{default:(0,t.k6)((()=>[(0,t.bF)(s,{label:"ID",width:"60"},{default:(0,t.k6)((e=>[(0,t.eW)((0,r.v_)(e.$index+1+(K.page-1)*K.limit),1)])),_:1}),(0,t.bF)(s,{prop:"title",label:"标题",width:"150"}),(0,t.bF)(s,{prop:"description",label:"描述","min-width":"300"},{default:(0,t.k6)((e=>[(0,t.Lk)("div",v,(0,r.v_)(e.row.description),1)])),_:1}),(0,t.bF)(s,{label:"创建时间",width:"220"},{default:(0,t.k6)((e=>[(0,t.eW)((0,r.v_)(z(e.row.createdAt)),1)])),_:1}),(0,t.bF)(s,{label:"更新时间",width:"220"},{default:(0,t.k6)((e=>[(0,t.eW)((0,r.v_)(z(e.row.updatedAt)),1)])),_:1}),(0,t.bF)(s,{label:"操作",width:"100",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(D,{trigger:"hover",placement:"bottom-start"},{dropdown:(0,t.k6)((()=>[(0,t.bF)(W,null,{default:(0,t.k6)((()=>[(0,t.bF)(h,{onClick:l=>I(e.row.id)},{default:(0,t.k6)((()=>[(0,t.bF)(u,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(d.Ss2))])),_:1}),l[9]||(l[9]=(0,t.Lk)("span",{style:{"margin-left":"8px"}},"详情",-1))])),_:2},1032,["onClick"]),(0,t.bF)(h,{onClick:l=>S(e.row.id)},{default:(0,t.k6)((()=>[(0,t.bF)(u,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(d.SYj))])),_:1}),l[10]||(l[10]=(0,t.Lk)("span",{style:{"margin-left":"8px"}},"可视化",-1))])),_:2},1032,["onClick"]),(0,t.bF)(h,{onClick:l=>T(e.row.id)},{default:(0,t.k6)((()=>[(0,t.bF)(u,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(d.pT5))])),_:1}),l[11]||(l[11]=(0,t.Lk)("span",{style:{"margin-left":"8px"}},"生成文本",-1))])),_:2},1032,["onClick"]),(0,t.bF)(h,{onClick:l=>j(e.row.id)},{default:(0,t.k6)((()=>[(0,t.bF)(u,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(d.B8B))])),_:1}),l[12]||(l[12]=(0,t.Lk)("span",{style:{"margin-left":"8px"}},"生成记录",-1))])),_:2},1032,["onClick"]),(0,t.bF)(h,{divided:"",onClick:l=>q(e.row.id)},{default:(0,t.k6)((()=>[(0,t.bF)(u,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(d.epd))])),_:1}),l[13]||(l[13]=(0,t.Lk)("span",{style:{"margin-left":"8px",color:"#F56C6C"}},"删除",-1))])),_:2},1032,["onClick"])])),_:2},1024)])),default:(0,t.k6)((()=>[(0,t.bF)(i,{type:"info",plain:"",size:"small",style:{color:"#909399","background-color":"#f4f4f5","border-color":"#dcdfe6"}},{default:(0,t.k6)((()=>[(0,t.bF)(u,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(d.yGC))])),_:1})])),_:1})])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[Q,a.value]]),(0,t.Lk)("div",f,[(0,t.bF)(G,{"current-page":K.page,"onUpdate:currentPage":l[1]||(l[1]=e=>K.page=e),"page-size":K.limit,"onUpdate:pageSize":l[2]||(l[2]=e=>K.limit=e),"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:L.value,onSizeChange:U,onCurrentChange:A},null,8,["current-page","page-size","total"])])])]),(0,t.bF)(P,{modelValue:F.value,"onUpdate:modelValue":l[6]||(l[6]=e=>F.value=e),title:"创建事件图",width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",m,[(0,t.bF)(i,{onClick:l[5]||(l[5]=e=>F.value=!1)},{default:(0,t.k6)((()=>l[14]||(l[14]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(i,{type:"primary",onClick:$,loading:w.value},{default:(0,t.k6)((()=>l[15]||(l[15]=[(0,t.eW)("创建")]))),_:1},8,["loading"])])])),default:(0,t.k6)((()=>[(0,t.bF)(N,{ref_key:"createFormRef",ref:y,model:C,rules:V,"label-width":"80px"},{default:(0,t.k6)((()=>[(0,t.bF)(X,{label:"标题",prop:"title"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{modelValue:C.title,"onUpdate:modelValue":l[3]||(l[3]=e=>C.title=e),placeholder:"请输入事件图标题"},null,8,["modelValue"])])),_:1}),(0,t.bF)(X,{label:"描述",prop:"description"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{modelValue:C.description,"onUpdate:modelValue":l[4]||(l[4]=e=>C.description=e),type:"textarea",rows:4,placeholder:"请输入事件图描述"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])}}},_=a(1241);const F=(0,_.A)(h,[["__scopeId","data-v-de7623e0"]]);var w=F}}]);