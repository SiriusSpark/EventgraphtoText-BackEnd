"use strict";(self["webpackChunktext_generation_system"]=self["webpackChunktext_generation_system"]||[]).push([[332],{3332:function(e,l,a){a.r(l),a.d(l,{default:function(){return L}});a(4114),a(8111),a(116);var t=a(6768),n=a(4232),s=a(144),d=a(1387),r=a(1219),u=a(8270),i=a(7477);const o={class:"event-graph-detail-container"},v={class:"header"},c={class:"description"},b={class:"header-buttons"},p={class:"content-wrapper"},k={class:"content"},h={class:"section"},_={class:"section-header"},g={class:"section"},f={class:"section-header"},w={key:1},F={key:2};var y={__name:"detail",setup(e){const l=(0,d.lq)(),a=(0,d.rd)(),y=(0,s.KR)(!1),E=(0,s.KR)({title:"",description:"",nodes:[],edges:[]}),C=(0,s.KR)([]),L=(0,s.KR)(-1),W=(0,t.EW)((()=>l.params.id)),m=(0,t.EW)((()=>L.value>0)),S=(0,t.EW)((()=>L.value<C.value.length-1&&L.value>=0)),R=e=>{if(!E.value.nodes)return e;const l=E.value.nodes.find((l=>l.id===e));return l?l.title:e},I=e=>{const l={PRECEDES:"先于",FOLLOWS:"后于",CONCURRENT_WITH:"同时",CAUSES:"导致",RESULTS_IN:"结果",COREFERS_TO:"共指",HAS_SUBEVENT:"包含子事件",SUBEVENT_OF:"属于"};return l[e]||e},x=e=>["CAUSES","RESULTS_IN"].includes(e),T=()=>{a.push("/event-graph/list")},A=()=>{a.push(`/event-graph/edit/${W.value}`)},N=e=>{let l=-1;if("prev"===e&&m.value?l=L.value-1:"next"===e&&S.value&&(l=L.value+1),l>=0&&l<C.value.length){const e=C.value[l];y.value=!0,a.push(`/event-graph/detail/${e.id}`).then((()=>{X().then((()=>{L.value=l}))}))}},U=async()=>{try{const e=await(0,u.Z$)();e&&Array.isArray(e)?C.value=e.sort(((e,l)=>e.id-l.id)):e&&e.success&&Array.isArray(e.data)?C.value=e.data.sort(((e,l)=>e.id-l.id)):(console.error("获取事件图列表失败"),C.value=[]),W.value&&(L.value=C.value.findIndex((e=>e.id==W.value)))}catch(e){console.error("获取事件图列表失败:",e),r.nk.error("获取事件图列表失败"),C.value=[]}},X=async()=>{if(W.value){y.value=!0;try{console.log("获取事件图详情:",W.value);const e=await(0,u.kW)(W.value);console.log("事件图详情数据:",e),e&&e.success&&e.data?E.value=e.data:(r.nk.error(e?.message||e?.error||"获取事件图详情失败"),E.value={nodes:[],edges:[]})}catch(e){console.error("获取事件图详情失败:",e),r.nk.error("获取事件图详情失败"),E.value={nodes:[],edges:[]}}finally{y.value=!1}}else r.nk.error("未找到事件图ID")};return(0,t.wB)((()=>l.params.id),((e,l)=>{e&&e!==l&&(X(),C.value.length>0&&(L.value=C.value.findIndex((l=>l.id==e))))})),(0,t.sV)((async()=>{await U(),X()})),(e,l)=>{const a=(0,t.g2)("el-button"),d=(0,t.g2)("el-icon"),r=(0,t.g2)("el-table-column"),u=(0,t.g2)("el-tag"),C=(0,t.g2)("el-table"),L=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",o,[(0,t.Lk)("div",v,[(0,t.Lk)("div",null,[(0,t.Lk)("h2",null,"事件图详情："+(0,n.v_)(E.value.title),1),(0,t.Lk)("div",c,(0,n.v_)(E.value.description),1)]),(0,t.Lk)("div",b,[(0,t.bF)(a,{type:"primary",onClick:A},{default:(0,t.k6)((()=>l[2]||(l[2]=[(0,t.eW)("编辑")]))),_:1}),(0,t.bF)(a,{onClick:T},{default:(0,t.k6)((()=>l[3]||(l[3]=[(0,t.eW)("返回列表")]))),_:1})])]),(0,t.Lk)("div",p,[(0,t.Lk)("div",{class:(0,n.C4)(["nav-button left-button",{disabled:!m.value}]),onClick:l[0]||(l[0]=e=>N("prev"))},[(0,t.bF)(d,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,s.R1)(i.nkM))])),_:1})],2),(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",k,[(0,t.Lk)("div",h,[(0,t.Lk)("div",_,[(0,t.Lk)("h3",null,"事件节点 ("+(0,n.v_)(E.value.nodes?E.value.nodes.length:0)+")",1)]),(0,t.bF)(C,{data:E.value.nodes||[],border:""},{default:(0,t.k6)((()=>[(0,t.bF)(r,{label:"ID",width:"80"},{default:(0,t.k6)((e=>[(0,t.eW)((0,n.v_)(e.$index+1),1)])),_:1}),(0,t.bF)(r,{label:"标题",prop:"title","min-width":"90"}),(0,t.bF)(r,{label:"描述",prop:"description","min-width":"380","show-overflow-tooltip":""}),(0,t.bF)(r,{label:"位置",prop:"location",width:"120"}),(0,t.bF)(r,{label:"标签","min-width":"150"},{default:(0,t.k6)((e=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.row.labels,(e=>((0,t.uX)(),(0,t.Wv)(u,{key:e,size:"small",style:{"margin-right":"5px"}},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e),1)])),_:2},1024)))),128))])),_:1}),(0,t.bF)(r,{label:"开始时间",prop:"startTime",width:"120"}),(0,t.bF)(r,{label:"结束时间",prop:"endTime",width:"120"})])),_:1},8,["data"])]),(0,t.Lk)("div",g,[(0,t.Lk)("div",f,[(0,t.Lk)("h3",null,"事件关系 ("+(0,n.v_)(E.value.edges?E.value.edges.length:0)+")",1)]),(0,t.bF)(C,{data:E.value.edges||[],border:""},{default:(0,t.k6)((()=>[(0,t.bF)(r,{label:"ID",width:"80"},{default:(0,t.k6)((e=>[(0,t.eW)((0,n.v_)(e.$index+1),1)])),_:1}),(0,t.bF)(r,{label:"起始节点",width:"150"},{default:(0,t.k6)((e=>[(0,t.eW)((0,n.v_)(R(e.row.sourceId)),1)])),_:1}),(0,t.bF)(r,{label:"关系类型",prop:"type",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(u,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(I(e.row.type)),1)])),_:2},1024)])),_:1}),(0,t.bF)(r,{label:"目标节点",width:"150"},{default:(0,t.k6)((e=>[(0,t.eW)((0,n.v_)(R(e.row.targetId)),1)])),_:1}),(0,t.bF)(r,{label:"强度",prop:"strength",width:"100"},{default:(0,t.k6)((e=>[x(e.row.type)&&e.row.strength?((0,t.uX)(),(0,t.Wv)(u,{key:0,type:"info"},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.row.strength),1)])),_:2},1024)):x(e.row.type)&&!e.row.strength?((0,t.uX)(),(0,t.CE)("span",w,"未设置")):((0,t.uX)(),(0,t.CE)("span",F,"-"))])),_:1})])),_:1},8,["data"])])])),[[L,y.value]]),(0,t.Lk)("div",{class:(0,n.C4)(["nav-button right-button",{disabled:!S.value}]),onClick:l[1]||(l[1]=e=>N("next"))},[(0,t.bF)(d,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,s.R1)(i.Qpb))])),_:1})],2)])])}}},E=a(1241);const C=(0,E.A)(y,[["__scopeId","data-v-3d3c1b25"]]);var L=C}}]);